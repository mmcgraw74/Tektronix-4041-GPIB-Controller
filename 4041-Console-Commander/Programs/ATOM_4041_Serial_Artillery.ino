/*  Short Press the key control switch to change console to COMM0: 
 *
 *  LONG press the key control switch (more than 1 second) to load AdvTek4041S and change console to COMM0:
*/
#include <M5Atom.h>
#include "utility/M5Timer.h"

int oneshot = 0;

M5Timer M5timer;
void Timeout(){

   M5.update();
   if (M5.Btn.read()) {
    // for Btn held over 500msec - send Artillery program and then change console to comm0:
    M5.dis.drawpix(0, 0x00ffff);
    M5.update();
    
    // Send Super Artillery program
    Serial2.println("1 Goto 100");
    delay(750);
    Serial2.println("100 Init");
    delay(750);
    Serial2.println("102 Rem Set driver \"COMM1(BAUD=9600,FLA=BID,EDIT=STORAGE):\"");
    delay(750);
    Serial2.println("103 Rem Set console \"COMM1(ECHO=YES):\"");
    delay(750);
    Serial2.println("104 Open #10,\"COMM0:\"");
    delay(750);
    Serial2.println("105 Rcall \"GINIT\",10,4014,1");
    delay(750);
    Serial2.println("110 PAGE");
    delay(750);
    Serial2.println("120 Print \"SUPER ARTILLERY has the following changes from regular ARTILLERY\"");
    delay(750);
    Serial2.println("130 Rcall \"MOVE\",0,97");
    delay(750);
    Serial2.println("135 Rcall \"rdraw\",26,0");
    delay(750);
    Serial2.println("138 Rcall \"MOVE\",0,92");
    delay(750);
    Serial2.println("140 Print \"1.Input ANGLE,VELOCITY eg. 70,100\"");
    delay(750);
    Serial2.println("150 Print \"2.Allows wind to vary both in direction and strength.\"");
    delay(750);
    Serial2.println("160 Print \"(both between shots and small fluctuations during shot)\"");
    delay(750);
    Serial2.println("170 Print \"3.Each gun company starts with 100 men.After each shot\"");
    delay(750);
    Serial2.println("180 Print \"there is a deserter on each side.Near misses can cause\"");
    delay(750);
    Serial2.println("190 Print \"casualties, dependent on distance and # of men remaining.\"");
    delay(750);
    Serial2.println("200 Print \"A near miss which would bring a gun company to less than\"");
    delay(750);
    Serial2.println("210 Print \"10 men is treated as a direct hit.A running total of\"");
    delay(750);
    Serial2.println("220 Print \"casualties is maintained between battles for each side.\"");
    delay(750);
    Serial2.println("230 Print \"4.Misses leave craters; therefore they can be used to\"");
    delay(750);
    Serial2.println("240 Print \"lower a large mountain!\"");
    delay(750);
    Serial2.println("250 Print \"5.If desertion brings your gun company to less than 5 men,\"");
    delay(750);
    Serial2.println("260 Print \"your gun misfires.\"");
    delay(750);
    Serial2.println("270 Print \"6.Allows display of path of shot or just the shell\"");
    delay(750);
    Serial2.println("280 Print \"as it moves through the air.\"");
    delay(750);
    Serial2.println("290 Print \"7.Allows multiple guns.\"");
    delay(750);
    Serial2.println("300 Print \"(while at full strength (=>70 men) you are asked for\"");
    delay(750);
    Serial2.println("310 Print \"the angle, and velocity of your main gun and then\"");
    delay(750);
    Serial2.println("320 Print \"a delta angle and velocity for your second gun\"");
    delay(750);
    Serial2.println("330 Print \"(deltas added) and third gun (deltas subtracted).\"");
    delay(750);
    Serial2.println("340 Print \"If your gun company is reduced to <70 men but =>35\"");
    delay(750);
    Serial2.println("350 Print \"you lose your third gun. At <35 men you lose your\"");
    delay(750);
    Serial2.println("360 Print \"second gun.\"");
    delay(750);
    Serial2.println("370 Print \"8.You can erase and redraw the display by inputting\"");
    delay(750);
    Serial2.println("380 Print \"180 for the angle.\"");
    delay(750);
    Serial2.println("390 Print");
    delay(750);
    Serial2.println("400 Print \"TYPE Y IF YOU WANT VARYING WIND: \";");
    delay(750);
    Serial2.println("410 Input q$");
    delay(750);
    Serial2.println("420 Print \"TYPE Y IF YOU WANT TO SEE THE PATH OF THE SHOT.\"");
    delay(750);
    Serial2.println("430 Print \"OTHERWISE YOU WILL SEE JUST THE SHELL MOVE THROUGH\"");
    delay(750);
    Serial2.println("440 Print \"THE AIR AND IT WILL LEAVE NO TRACKS! \";");
    delay(750);
    Serial2.println("450 Input r$");
    delay(750);
    Serial2.println("460 Print \"TYPE Y IF YOU WANT MULTIPLE GUNS: \";");
    delay(750);
    Serial2.println("470 Input g$");
    delay(750);
    Serial2.println("475 Q1=rnd(-1)");
    delay(750);
    Serial2.println("480 Q1=0");
    delay(750);
    Serial2.println("490 If q$<>\"Y\" then goto 510");
    delay(750);
    Serial2.println("500 Q1=1");
    delay(750);
    Serial2.println("510 R1=0");
    delay(750);
    Serial2.println("520 If r$<>\"Y\" then goto 540");
    delay(750);
    Serial2.println("530 R1=1");
    delay(750);
    Serial2.println("540 G1=0");
    delay(750);
    Serial2.println("550 If g$<>\"Y\" then goto 570");
    delay(750);
    Serial2.println("560 G1=1");
    delay(750);
    Serial2.println("570 Dim h(129),a1(2),a2(2),b1(4),b2(4),l(2),m1(2),d3(8),d4(8)");
    delay(750);
    Serial2.println("580 Dim d5(6),d6(6)");
    delay(750);
    Serial2.println("585 Integer d8,d9,t1(2)");
    delay(750);
    Serial2.println("590 N=1.5+1^int(100*rnd(1))*0.5");
    delay(750);
    Serial2.println("600 Data 101,101,0,90,96,96,-1,1,1,-1,-1,-1,1,1");
    delay(750);
    Serial2.println("610 Data 2,-1.5,-1,0,-1,1.5,3,-0.5,2.5,-3,0.5,-2.5");
    delay(750);
    Serial2.println("620 Data 10,-5,-1,-4,-4,1,-4,7,10,-3,10,-8,4,-6,2,-9");
    delay(750);
    Serial2.println("630 T1(1)=0");
    delay(750);
    Serial2.println("640 T1(2)=0");
    delay(750);
    Serial2.println("650 Restore");
    delay(750);
    Serial2.println("660 Read m1,a1,a2,b1,b2,d5,d6,d3,d4");
    delay(750);
    Serial2.println("665 Rem SET DEGREES WITH ANGLE=1 ON 4041");
    delay(750);
    Serial2.println("670 Set angle 1");
    delay(750);
    Serial2.println("680 PAGE");
    delay(750);
    Serial2.println("690 N2=0");
    delay(750);
    Serial2.println("700 E3=0");
    delay(750);
    Serial2.println("710 V3=0");
    delay(750);
    Serial2.println("720 X1=int(20+rnd(1)*30)");
    delay(750);
    Serial2.println("730 X2=int(80+rnd(1)*30)");
    delay(750);
    Serial2.println("740 L(1)=int(10+(x1-10)*rnd(1))");
    delay(750);
    Serial2.println("750 L(2)=int(x2+(120-x2)*rnd(1))");
    delay(750);
    Serial2.println("760 H9=rnd(1)*58+2");
    delay(750);
    Serial2.println("770 For i=1 to x1");
    delay(750);
    Serial2.println("780 H(i)=h9");
    delay(750);
    Serial2.println("790 Next i");
    delay(750);
    Serial2.println("800 H9=rnd(1)*58+2");
    delay(750);
    Serial2.println("810 For i=x2 to 129");
    delay(750);
    Serial2.println("820 H(i)=h9");
    delay(750);
    Serial2.println("830 Next i");
    delay(750);
    Serial2.println("840 X3=x1+int(rnd(1)*(x2-x1-20))+10");
    delay(750);
    Serial2.println("850 H(x3)=rnd(1)*70+20");
    delay(750);
    Serial2.println("860 D1=(h(x3)-h(1))/2");
    delay(750);
    Serial2.println("870 D2=(h(x3)-h(129))/2");
    delay(750);
    Serial2.println("880 If d1*d2<=0 then goto 1040");
    delay(750);
    Serial2.println("890 J=-180");
    delay(750);
    Serial2.println("900 K=180/(x3-x1+1)");
    delay(750);
    Serial2.println("910 H9=h(1)+d1");
    delay(750);
    Serial2.println("920 For i=x1+1 to x3-1");
    delay(750);
    Serial2.println("930 J=j+k");
    delay(750);
    Serial2.println("940 H(i)=h9+cos(j)*d1");
    delay(750);
    Serial2.println("950 Next i");
    delay(750);
    Serial2.println("960 J=0");
    delay(750);
    Serial2.println("970 K=180/(x2-x3+1)");
    delay(750);
    Serial2.println("980 H9=h(129)+d2");
    delay(750);
    Serial2.println("990 For i=x3+1 to x2-1");
    delay(750);
    Serial2.println(" 1000 J=j+k");
    delay(750);
    Serial2.println(" 1010 H(i)=h9+cos(j)*d2");
    delay(750);
    Serial2.println(" 1020 Next i");
    delay(750);
    Serial2.println(" 1030 Goto 1120");
    delay(750);
    Serial2.println(" 1040 D=(h(1)-h(129))/2");
    delay(750);
    Serial2.println(" 1050 J=0");
    delay(750);
    Serial2.println(" 1060 K=180/(x2-x1+1)");
    delay(750);
    Serial2.println(" 1070 H9=h(129)+d");
    delay(750);
    Serial2.println(" 1080 For i=x1+1 to x2-1");
    delay(750);
    Serial2.println(" 1090 J=j+k");
    delay(750);
    Serial2.println(" 1100 H(i)=h9+cos(j)*d");
    delay(750);
    Serial2.println(" 1110 Next i");
    delay(750);
    Serial2.println(" 1120 Gosub 2200");
    delay(750);
    Serial2.println(" 1130 Gosub 2500");
    delay(750);
    Serial2.println(" 1140 W=100*rnd(1)-50");
    delay(750);
    Serial2.println(" 1150 If w=0 then goto 1140");
    delay(750);
    Serial2.println(" 1160 Goto 1210");
    delay(750);
    Serial2.println(" 1170 If q1<>1 then goto 1210");
    delay(750);
    Serial2.println(" 1180 W3=w+18*(rnd(1)-0.5)");
    delay(750);
    Serial2.println(" 1190 If abs(w3)>50 then goto 1180");
    delay(750);
    Serial2.println(" 1200 W=w3");
    delay(750);
    Serial2.println(" 1210 N=3-n");
    delay(750);
    Serial2.println(" 1220 M1(n)=m1(n)-1");
    delay(750);
    Serial2.println(" 1230 M1(3-n)=m1(3-n)-1");
    delay(750);
    Serial2.println(" 1240 Rcall \"MOVE\",a1(n),a2(n)");
    delay(750);
    Serial2.println(" 1250 Print \"WIND \";int(w);\" MPH *\";");
    delay(750);
    Serial2.println(" 1260 Input e,v");
    delay(750);
    Serial2.println(" 1270 If e=180 then goto 2430");
    delay(750);
    Serial2.println(" 1280 V=v/10");
    delay(750);
    Serial2.println(" 1290 If m1(n)>5 then goto 1330");
    delay(750);
    Serial2.println(" 1300 E=90");
    delay(750);
    Serial2.println(" 1310 V=0");
    delay(750);
    Serial2.println(" 1320 W=1");
    delay(750);
    Serial2.println(" 1330 A2(n)=a2(n)-2.75");
    delay(750);
    Serial2.println(" 1340 E=90-e");
    delay(750);
    Serial2.println(" 1350 C=1");
    delay(750);
    Serial2.println(" 1360 If g1<>1 or m1(n)<35 then goto 1430");
    delay(750);
    Serial2.println(" 1370 Rcall \"MOVE\",a1(n),a2(n)");
    delay(750);
    Serial2.println(" 1380 Print \"DELTA ANG,VEL=\";");
    delay(750);
    Serial2.println(" 1390 Input e3,v3");
    delay(750);
    Serial2.println(" 1400 V3=v3/10");
    delay(750);
    Serial2.println(" 1410 A2(n)=a2(n)-2.75");
    delay(750);
    Serial2.println(" 1420 C=int(m1(n)/35)+1");
    delay(750);
    Serial2.println(" 1430 Rem only 4050 SET KEY");
    delay(750);
    Serial2.println(" 1440 If n=1 then goto 1470");
    delay(750);
    Serial2.println(" 1450 E=-e");
    delay(750);
    Serial2.println(" 1460 E3=-e3");
    delay(750);
    Serial2.println(" 1470 X1=l(n)");
    delay(750);
    Serial2.println(" 1480 Y1=h(l(n))");
    delay(750);
    Serial2.println(" 1490 T=0");
    delay(750);
    Serial2.println(" 1500 V1=sin(e)*v");
    delay(750);
    Serial2.println(" 1510 V2=cos(e)*v");
    delay(750);
    Serial2.println(" 1520 Rcall \"MOVE\",l(n),h(l(n))");
    delay(750);
    Serial2.println(" 1530 T=t+0.3");
    delay(750);
    Serial2.println(" 1540 If q1<>1 then goto 1580");
    delay(750);
    Serial2.println(" 1550 W3=w+rnd(1)-0.5");
    delay(750);
    Serial2.println(" 1560 If w3>50 or w3<-50 then goto 1550");
    delay(750);
    Serial2.println(" 1570 W=w3");
    delay(750);
    Serial2.println(" 1580 V1=v1+(v1+w)/1500");
    delay(750);
    Serial2.println(" 1590 X=x1+(v1+w/50)*t");
    delay(750);
    Serial2.println(" 1600 If x<1 or x>129 then goto 2290");
    delay(750);
    Serial2.println(" 1610 Rem ACCOUNT FOR GRAVITY AND ACCELERATION");
    delay(750);
    Serial2.println(" 1620 Y=y1+(v2-t/2.5)*t");
    delay(750);
    Serial2.println(" 1630 If r1=1 then goto 1670");
    delay(750);
    Serial2.println(" 1640 Rcall \"MOVE\",x,y");
    delay(750);
    Serial2.println(" 1645 Rem 4014 ESC to write-thru \"o\" and back to normal");
    delay(750);
    Serial2.println(" 1650 Print \"\";");
    delay(750);
    Serial2.println(" 1660 Goto 1680");
    delay(750);
    Serial2.println(" 1670 Rcall \"DRAW\",x,y");
    delay(750);
    Serial2.println(" 1680 If y-h(x)>=1 then goto 1530");
    delay(750);
    Serial2.println(" 1690 If abs(x-l(n))<1 and t>0.5 then goto 2040");
    delay(750);
    Serial2.println(" 1700 If abs(x-l(3-n))<1 then goto 2030");
    delay(750);
    Serial2.println(" 1710 If t<0.5 then goto 1530");
    delay(750);
    Serial2.println(" 1720 Rem MISS");
    delay(750);
    Serial2.println(" 1730 If r$=\"Y\" then goto 1780");
    delay(750);
    Serial2.println(" 1740 For i=1 to 6");
    delay(750);
    Serial2.println(" 1745 Rem 4014 ESC to write-thru \"*\" and back to normal");
    delay(750);
    Serial2.println(" 1750 Print \"\";");
    delay(750);
    Serial2.println(" 1760 Next i");
    delay(750);
    Serial2.println(" 1770 Goto 1790");
    delay(750);
    Serial2.println(" 1780 For i=1 to 6");
    delay(750);
    Serial2.println(" 1782 Rcall \"RDRAW\",d5,d6");
    delay(750);
    Serial2.println(" 1784 Next i");
    delay(750);
    Serial2.println(" 1790 If x<4 then goto 1880");
    delay(750);
    Serial2.println(" 1800 If x>126 then goto 1880");
    delay(750);
    Serial2.println(" 1810 H(x-3)=h(x-3)-1");
    delay(750);
    Serial2.println(" 1820 H(x-2)=h(x-2)-2");
    delay(750);
    Serial2.println(" 1830 H(x-1)=h(x-1)-3.5");
    delay(750);
    Serial2.println(" 1840 H(x)=h(x)-4");
    delay(750);
    Serial2.println(" 1850 H(x+1)=h(x+1)-3.5");
    delay(750);
    Serial2.println(" 1860 H(x+2)=h(x+2)-2");
    delay(750);
    Serial2.println(" 1870 H(x+3)=h(x+3)-1");
    delay(750);
    Serial2.println(" 1880 If abs(x-l(3-n))>8 then goto 2290");
    delay(750);
    Serial2.println(" 1890 Rem NEAR MISS");
    delay(750);
    Serial2.println(" 1900 D9=1.5*abs(x-l(3-n))");
    delay(750);
    Serial2.println(" 1910 D9=int(m1(3-n)/d9)");
    delay(750);
    Serial2.println(" 1920 M1(3-n)=m1(3-n)-d9");
    delay(750);
    Serial2.println(" 1930 T1(3-n)=t1(3-n)+d9");
    delay(750);
    Serial2.println(" 1940 N2=1");
    delay(750);
    Serial2.println(" 1950 If m1(3-n)<10 then goto 2030");
    delay(750);
    Serial2.println(" 1960 N2=0");
    delay(750);
    Serial2.println(" 1970 Rcall \"MOVE\",a1(n),a2(n)");
    delay(750);
    Serial2.println(" 1980 A2(n)=a2(n)-2.75");
    delay(750);
    Serial2.println(" 1990 D8=-1^(n+1)*int(x-l(3-n))");
    delay(750);
    Serial2.println(" 2000 Print d9;\" ENEMY HIT-LOC = \";d8");
    delay(750);
    Serial2.println(" 2010 Goto 2290");
    delay(750);
    Serial2.println(" 2020 Rem HIT");
    delay(750);
    Serial2.println(" 2030 N=3-n");
    delay(750);
    Serial2.println(" 2040 Rcall \"MOVE\",x,y");
    delay(750);
    Serial2.println(" 2045 For i=1 to 8");
    delay(750);
    Serial2.println(" 2050 Rcall \"RDRAW\",d3(i),d4(i)");
    delay(750);
    Serial2.println(" 2055 Next i");
    delay(750);
    Serial2.println(" 2060 Rcall \"MOVE\",0,18");
    delay(750);
    Serial2.println(" 2070 T1(n)=t1(n)+m1(n)");
    delay(750);
    Serial2.println(" 2080 Print \"\"");
    delay(750);
    Serial2.println(" 2090 Print \"CASUALTIES - LEFT=\";t1(1)");
    delay(750);
    Serial2.println(" 2100 Print \" - RIGHT =\";t1(2)");
    delay(750);
    Serial2.println(" 2110 If n2=1 then goto 2130");
    delay(750);
    Serial2.println(" 2120 N=3-n");
    delay(750);
    Serial2.println(" 2130 Print \"AGAIN? \";");
    delay(750);
    Serial2.println(" 2140 Input a$");
    delay(750);
    Serial2.println(" 2150 If a$<>\"NO\" then goto 650");
    delay(750);
    Serial2.println(" 2160 Print \"Thanks for playing!\"");
    delay(750);
    Serial2.println(" 2170 Stop");
    delay(750);
    Serial2.println(" 2190 Rem Rcall \"DRAW\",TERAIN");
    delay(750);
    Serial2.println(" 2200 Rcall \"MOVE\",0.5,h(1)");
    delay(750);
    Serial2.println(" 2210 For i=1 to 129");
    delay(750);
    Serial2.println(" 2220 Rcall \"DRAW\",i,h(i)");
    delay(750);
    Serial2.println(" 2230 Next i");
    delay(750);
    Serial2.println(" 2240 Rcall \"MOVE\",l(1),h(l(1))+1");
    delay(750);
    Serial2.println(" 2245 For i=1 to 4");
    delay(750);
    Serial2.println(" 2250 Rcall \"RDRAW\",b1(i),b2(i)");
    delay(750);
    Serial2.println(" 2255 Next i");
    delay(750);
    Serial2.println(" 2260 Rcall \"MOVE\",l(2),h(l(2))+1");
    delay(750);
    Serial2.println(" 2265 For i=1 to 4");
    delay(750);
    Serial2.println(" 2270 Rcall \"RDRAW\",b1(i),b2(i)");
    delay(750);
    Serial2.println(" 2275 Next i");
    delay(750);
    Serial2.println(" 2280 Return");
    delay(750);
    Serial2.println(" 2290 C=c-1");
    delay(750);
    Serial2.println(" 2300 If c<1 then goto 2360");
    delay(750);
    Serial2.println(" 2310 E=e-e3");
    delay(750);
    Serial2.println(" 2320 V=v+v3");
    delay(750);
    Serial2.println(" 2330 E3=-2*e3");
    delay(750);
    Serial2.println(" 2340 V3=-2*v3");
    delay(750);
    Serial2.println(" 2350 Goto 1470");
    delay(750);
    Serial2.println(" 2360 Rem only 4050 SET NOKEY");
    delay(750);
    Serial2.println(" 2370 Gosub 2190");
    delay(750);
    Serial2.println(" 2380 Goto 1170");
    delay(750);
    Serial2.println(" 2390 For j1=1 to 3");
    delay(750);
    Serial2.println(" 2395 Rem 4014 ESC to write-thru \"*\" and back to normal");
    delay(750);
    Serial2.println(" 2400 Print \"\";");
    delay(750);
    Serial2.println(" 2410 Next j1");
    delay(750);
    Serial2.println(" 2420 Goto 2290");
    delay(750);
    Serial2.println(" 2430 A2(1)=96");
    delay(750);
    Serial2.println(" 2440 A2(2)=96");
    delay(750);
    Serial2.println(" 2450 PAGE");
    delay(750);
    Serial2.println(" 2460 Gosub 2190");
    delay(750);
    Serial2.println(" 2470 Gosub 2500");
    delay(750);
    Serial2.println(" 2480 Goto 1240");
    delay(750);
    Serial2.println(" 2490 Rem PRINT TITLES");
    delay(750);
    Serial2.println(" 2500 Rcall \"MOVE\",0,99");
    delay(750);
    Serial2.println(" 2510 Print \"INPUT ANGLE,VELOCITY\"");
    delay(750);
    Serial2.println(" 2512 Rcall \"MOVE\",0,98.8");
    delay(750);
    Serial2.println(" 2514 Rcall \"rdraw\",33,0");
    delay(750);
    Serial2.println(" 2520 Rcall \"MOVE\",90,99");
    delay(750);
    Serial2.println(" 2530 Print \"INPUT ANGLE,VELOCITY\"");
    delay(750);
    Serial2.println(" 2532 Rcall \"move\",90,98.8");
    delay(750);
    Serial2.println(" 2534 Rcall \"rdraw\",34,0");
    delay(750);
    Serial2.println(" 2540 Rcall \"MOVE\",50,90");
    delay(750);
    Serial2.println(" 2550 Print \"CASUALTIES\"");
    delay(750);
    Serial2.println(" 2560 Rcall \"MOVE\",48,87");
    delay(750);
    Serial2.println(" 2570 Print using \"5D,5D\":t1(1),t1(2)");
    delay(750);
    Serial2.println(" 2580 Rcall \"MOVE\",42,99");
    delay(750);
    Serial2.println(" 2590 Print \"+ WIND IS TO THE RIGHT\"");
    delay(750);
    Serial2.println(" 2600 Rcall \"MOVE\",42,96");
    delay(750);
    Serial2.println(" 2610 Print \"- WIND IS TO THE LEFT\"");
    delay(750);
    Serial2.println(" 2620 Return");
    delay(750);
    
    Serial2.println("Set driver \"COMM0(BAUD=9600,STOP=1,FLA=BID,EDIT=STORAGE):\"");
    delay(750);
    Serial2.println("set console\"COMM0:\" ! Artillery 9600 8N1");
    delay(2000);
    M5.dis.drawpix(0, 0x000000);
    M5.update();
    } else {
    // for Btn held less than 500msec - just change console to comm0:
    M5.dis.drawpix(0, 0x0000ff);
    M5.update();
    Serial2.println("Set driver \"COMM0(BAUD=9600,STOP=1,FLA=BID,EDIT=RAS):\"");
    Serial2.println("set console\"COMM0:\" !CON= COMM0 9600 8n1");
    delay(1000);
    M5.dis.drawpix(0, 0x000000);
    M5.update();
}
oneshot = 1;
}

void setup() {
   M5.begin(true, false, true);
   Serial2.begin(4800, SERIAL_8N1, 33, 23);
   M5.dis.drawpix(0, 0xff0000);
   M5.update();
   delay(1000);
   M5.dis.drawpix(0, 0x000000);
   M5.update();
 }

void loop() {
    if (oneshot==0) {  // stop looking for Btn press after first time
    M5.update();
    M5timer.run();
  // update button state
   if (M5.Btn.wasPressed()) { // this function is only true first time it is called after Btn was pressed
   M5timer.setTimeout(500,Timeout);
   }
 }
}
