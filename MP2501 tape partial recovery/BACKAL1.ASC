4!  *************************************************************8!  **                                                         **16!  **                   TAPE BACKUP PROGRAM                   **20!  **                      Version 2.0                ÿ        **22!  **                      File "BAKAL1"                      **24!  **                                                         **28!  **                       * * * * *                         **32!  **                                    ÿ                     **36!  **          COPYRIGHT (c) 1984 by TEKTRONIX, INC.          **40!  **                   ALL RIGHTS RESERVED                   **44!  **                                                         **48!  **                       ÿ* * * * *                         **52!  **                                                         **56!  **   This  software may not be  copied, in  whole or in    **60!  **   part, without written permission of Tektronix, Inc.,  **64!  **   except ÿfor back-up and  archive  purposes.  Removal   **68!  **   of this Copyright and Disclaimer  statement will be   **72!  **   violation of the Copyright.                           **76!  **                                                         **80! ÿ **                                                         **84!  *************************************************************100!110!120!  This program will read in a master tape completely into memory.130!  The user will then be requested to placÿe blank or formated tapes140!  into the drive and the master copy will be duplicated.150Dele var all160Comp 170Memsize=ask("memory",all)180Elements=int(memsize/256)-32190Dim file$(elements)to 256,direct$ to 1024,record$ to 256200Dim volume$ to 15,sÿerial$ to 8,mrec1$ to 256,drec1$ to 256210Set upca 0! compare all ASCII220!----- Start of duplication process -----230Prin usin"=70a":"TAPE BACKUP PROGRAM"240Prin usin"//=70a":"COPYRIGHT (c) 1984 by TEKTRONIX, INC."250Prin usin"=70a":"ALL RIGHTS RESEÿRVED"260Inpu prom"   

Enter Time DD-MON-YY HH:MM ":time$270Set time time$280Begin:inpu prom"Place master tape in the tape drive and press <RETURN> :":a$290!----- Read in tape directory -----300Set sysd"tape:"310Open#1:"TAPE(PHY=YES):"320Rbyt#1:1,mÿrec1$330! Seg$ out the time field from the first record in the master.340Serial$=seg$(mrec1$,41,8)350Volume$=ask$("volume")360For position=2 to 4370Rbyt#1:position,record$380Direct$=direct$&record$390Next position400!----- Find last record used onÿ the tape -----410Records=0420For i=1 to 48430Rec=(asc(seg$(direct$,((i-1)*16)+8,1))*256)+asc(seg$(direct$,((i-1)*16)+7,1))440Num=(asc(seg$(direct$,((i-1)*16)+10,1))*256)+asc(seg$(direct$,((i-1)*16)+9,1))450If rec<>0 then records=rec+num460If rec=0 ÿthen exit  to endfind470Next i480Endfind:if records-4>elements then goto moremem490!----- Read in all the data records from the master tape -----500For position=5 to records510Rbyt#1:position,file$(position-4)520Next position530Clos 1540On erro(10ÿ00)then call trapout550!----- Duplicate the master tape -----560Duplicat:prin 570Inpu prom"Place a tape in the tape drive and press <RETURN> :":a$580Copyit:form volume$590! Put in time field read from master with rep$ function600Open#1:"TAPE(PHY=YESÿ):"610Rbyt#1:1,drec1$620Rep$(drec1$,41,8)=serial$630Wbyt#1:1,drec1$640For position=2 to 4650Record$=seg$(direct$,((position-2)*256)+1,256)660Wbyt#1:position,record$670Rbyt#1:position,v_rec$680If v_rec$<>record$ then call verif_er(position)690Nextÿ position700For position=5 to records710Wbyt#1:position,file$(position-4)720Next position730For position=5 to records740Rbyt#1:position,v_rec$750If v_rec$<>file$(position-4)then call verif_er(position)760Next position770Clos 1780Inpu prom"

Copyÿ completed.  Do you wish another copy? <y> or <RETURN> to exit. ":ans$790If ans$=""then goto 850800If ans$<>"y"then goto 780810Goto duplicat820Moremem:clos 1830Prin 840Prin"Tape records exceed the amount of memory for copy."850End900Sub verif_er(vÿar rec)910Prin" Verify read-back error at record # ";rec920Prin#"prin:":"Read Error REC# ";rec930Prin#"frtp:":"Read Error REC# ";rec940Prin"
 Aborting Duplication

"950Clos 1960Trap970End1000Sub trapout! user error trapout to line duplicat1010Brÿan duplicat1020End