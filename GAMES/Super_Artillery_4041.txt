    1     Goto 100  100     Init  102   Rem Set driver "COMM1(BAUD=9600,FLA=BID,EDIT=STORAGE):"  103   Rem Set console "COMM1(ECHO=YES):"  104     Open #10,"COMM0:"  105     Rcall "GINIT",10,4014,1  110     PAGE  120     Print "SUPER ARTILLERY has the following changes from regular ARTILLERY"  130     Rcall "MOVE",0,97  135     Rcall "rdraw",26,0  138     Rcall "MOVE",0,92  140     Print "1.Input ANGLE,VELOCITY eg. 70,100"  150     Print "2.Allows wind to vary both in direction and strength."  160     Print "  (both between shots and small fluctuations during shot)"  170     Print "3.Each gun company starts with 100 men.  After each shot"  180     Print "  there is a deserter on each side.  Near misses can cause"  190     Print "  casualties, dependent on distance and # of men remaining."  200     Print "  A near miss which would bring a gun company to less than"  210     Print "  10 men is treated as a direct hit.  A running total of"  220     Print "  casualties is maintained between battles for each side."  230     Print "4.Misses leave craters; therefore they can be used to"  240     Print "  lower a large mountain!"  250     Print "5.If desertion brings your gun company to less than 5 men,"  260     Print "  your gun misfires."  270     Print "6.Allows display of path of shot or just the shell"  280     Print "  as it moves through the air."  290     Print "7.Allows multiple guns."  300     Print "  (while at full strength (=>70 men) you are asked for"  310     Print "  the angle, and velocity of your main gun and then"  320     Print "  a delta angle and velocity for your second gun"  330     Print "  (deltas added) and third gun (deltas subtracted)."  340     Print "  If your gun company is reduced to <70 men but =>35"  350     Print "  you lose your third gun. At <35 men you lose your"  360     Print "  second gun."  370     Print "8.You can erase and redraw the display by inputting"  380     Print "  180 for the angle."  390     Print  400     Print "TYPE Y IF YOU WANT VARYING WIND: ";  410     Input q$  420     Print "TYPE Y IF YOU WANT TO SEE THE PATH OF THE SHOT."  430     Print "OTHERWISE YOU WILL SEE JUST THE SHELL MOVE THROUGH"  440     Print "THE AIR AND IT WILL LEAVE NO TRACKS! ";  450     Input r$  460     Print "TYPE Y IF YOU WANT MULTIPLE GUNS: ";  470     Input g$  475     Q1=rnd(-1)  480     Q1=0  490     If q$<>"Y" then goto 510  500     Q1=1  510     R1=0  520     If r$<>"Y" then goto 540  530     R1=1  540     G1=0  550     If g$<>"Y" then goto 570  560     G1=1  570     Dim h(129),a1(2),a2(2),b1(4),b2(4),l(2),m1(2),d3(8),d4(8)  580     Dim d5(6),d6(6)  585     Integer d8,d9,t1(2)  590     N=1.5+1^int(100*rnd(1))*0.5  600     Data 101,101,0,90,96,96,-1,1,1,-1,-1,-1,1,1  610     Data 2,-1.5,-1,0,-1,1.5,3,-0.5,2.5,-3,0.5,-2.5  620     Data 10,-5,-1,-4,-4,1,-4,7,10,-3,10,-8,4,-6,2,-9  630     T1(1)=0  640     T1(2)=0  650     Restore  660     Read m1,a1,a2,b1,b2,d5,d6,d3,d4  665   Rem SET DEGREES WITH ANGLE=1 ON 4041  670     Set angle 1  680     PAGE  690     N2=0  700     E3=0  710     V3=0  720     X1=int(20+rnd(1)*30)  730     X2=int(80+rnd(1)*30)  740     L(1)=int(10+(x1-10)*rnd(1))  750     L(2)=int(x2+(120-x2)*rnd(1))  760     H9=rnd(1)*58+2  770     For i=1 to x1  780       H(i)=h9  790       Next i  800     H9=rnd(1)*58+2  810     For i=x2 to 129  820       H(i)=h9  830       Next i  840     X3=x1+int(rnd(1)*(x2-x1-20))+10  850     H(x3)=rnd(1)*70+20  860     D1=(h(x3)-h(1))/2  870     D2=(h(x3)-h(129))/2  880     If d1*d2<=0 then goto 1040  890     J=-180  900     K=180/(x3-x1+1)  910     H9=h(1)+d1  920     For i=x1+1 to x3-1  930       J=j+k  940       H(i)=h9+cos(j)*d1  950       Next i  960     J=0  970     K=180/(x2-x3+1)  980     H9=h(129)+d2  990     For i=x3+1 to x2-1 1000       J=j+k 1010       H(i)=h9+cos(j)*d2 1020       Next i 1030     Goto 1120 1040     D=(h(1)-h(129))/2 1050     J=0 1060     K=180/(x2-x1+1) 1070     H9=h(129)+d 1080     For i=x1+1 to x2-1 1090       J=j+k 1100       H(i)=h9+cos(j)*d 1110       Next i 1120     Gosub 2200 1130     Gosub 2500 1140     W=100*rnd(1)-50 1150     If w=0 then goto 1140 1160     Goto 1210 1170     If q1<>1 then goto 1210 1180     W3=w+18*(rnd(1)-0.5) 1190     If abs(w3)>50 then goto 1180 1200     W=w3 1210     N=3-n 1220     M1(n)=m1(n)-1 1230     M1(3-n)=m1(3-n)-1 1240     Rcall "MOVE",a1(n),a2(n) 1250     Print "WIND ";int(w);" MPH *"; 1260     Input e,v 1270     If e=180 then goto 2430 1280     V=v/10 1290     If m1(n)>5 then goto 1330 1300     E=90 1310     V=0 1320     W=1 1330     A2(n)=a2(n)-2.75 1340     E=90-e 1350     C=1 1360     If g1<>1 or m1(n)<35 then goto 1430 1370     Rcall "MOVE",a1(n),a2(n) 1380     Print "DELTA ANG,VEL="; 1390     Input e3,v3 1400     V3=v3/10 1410     A2(n)=a2(n)-2.75 1420     C=int(m1(n)/35)+1 1430   Rem only 4050 SET KEY 1440     If n=1 then goto 1470 1450     E=-e 1460     E3=-e3 1470     X1=l(n) 1480     Y1=h(l(n)) 1490     T=0 1500     V1=sin(e)*v 1510     V2=cos(e)*v 1520     Rcall "MOVE",l(n),h(l(n)) 1530     T=t+0.3 1540     If q1<>1 then goto 1580 1550     W3=w+rnd(1)-0.5 1560     If w3>50 or w3<-50 then goto 1550 1570     W=w3 1580     V1=v1+(v1+w)/1500 1590     X=x1+(v1+w/50)*t 1600     If x<1 or x>129 then goto 2290 1610   Rem ACCOUNT FOR GRAVITY AND ACCELERATION 1620     Y=y1+(v2-t/2.5)*t 1630     If r1=1 then goto 1670 1640     Rcall "MOVE",x,y 1645   Rem 4014 ESC to write-thru "o" and back to normal 1650     Print ""; 1660     Goto 1680 1670     Rcall "DRAW",x,y 1680     If y-h(x)>=1 then goto 1530 1690     If abs(x-l(n))<1 and t>0.5 then goto 2040 1700     If abs(x-l(3-n))<1 then goto 2030 1710     If t<0.5 then goto 1530 1720   Rem MISS 1730     If r$="Y" then goto 1780 1740     For i=1 to 6 1745   Rem 4014 ESC to write-thru "*" and back to normal 1750       Print ""; 1760       Next i 1770     Goto 1790 1780     For i=1 to 6 1782       Rcall "RDRAW",d5,d6 1784       Next i 1790     If x<4 then goto 1880 1800     If x>126 then goto 1880 1810     H(x-3)=h(x-3)-1 1820     H(x-2)=h(x-2)-2 1830     H(x-1)=h(x-1)-3.5 1840     H(x)=h(x)-4 1850     H(x+1)=h(x+1)-3.5 1860     H(x+2)=h(x+2)-2 1870     H(x+3)=h(x+3)-1 1880     If abs(x-l(3-n))>8 then goto 2290 1890   Rem NEAR MISS 1900     D9=1.5*abs(x-l(3-n)) 1910     D9=int(m1(3-n)/d9) 1920     M1(3-n)=m1(3-n)-d9 1930     T1(3-n)=t1(3-n)+d9 1940     N2=1 1950     If m1(3-n)<10 then goto 2030 1960     N2=0 1970     Rcall "MOVE",a1(n),a2(n) 1980     A2(n)=a2(n)-2.75 1990     D8=-1^(n+1)*int(x-l(3-n)) 2000     Print d9;" ENEMY HIT-LOC = ";d8 2010     Goto 2290 2020   Rem HIT 2030     N=3-n 2040     Rcall "MOVE",x,y 2045     For i=1 to 8 2050       Rcall "RDRAW",d3(i),d4(i) 2055       Next i 2060     Rcall "MOVE",0,18 2070     T1(n)=t1(n)+m1(n) 2080     Print "" 2090     Print "CASUALTIES - LEFT  =";t1(1) 2100     Print "           - RIGHT =";t1(2) 2110     If n2=1 then goto 2130 2120     N=3-n 2130     Print "AGAIN? "; 2140     Input a$ 2150     If a$<>"NO" then goto 650 2160     Print "Thanks for playing!" 2170     Stop 2190   Rem Rcall "DRAW",TERAIN 2200     Rcall "MOVE",0.5,h(1) 2210     For i=1 to 129 2220       Rcall "DRAW",i,h(i) 2230       Next i 2240     Rcall "MOVE",l(1),h(l(1))+1 2245     For i=1 to 4 2250       Rcall "RDRAW",b1(i),b2(i) 2255       Next i 2260     Rcall "MOVE",l(2),h(l(2))+1 2265     For i=1 to 4 2270       Rcall "RDRAW",b1(i),b2(i) 2275       Next i 2280     Return 2290     C=c-1 2300     If c<1 then goto 2360 2310     E=e-e3 2320     V=v+v3 2330     E3=-2*e3 2340     V3=-2*v3 2350     Goto 1470 2360   Rem only 4050 SET NOKEY 2370     Gosub 2190 2380     Goto 1170 2390     For j1=1 to 3 2395   Rem 4014 ESC to write-thru "*" and back to normal 2400       Print ""; 2410       Next j1 2420     Goto 2290 2430     A2(1)=96 2440     A2(2)=96 2450     PAGE 2460     Gosub 2190 2470     Gosub 2500 2480     Goto 1240 2490   Rem PRINT TITLES 2500     Rcall "MOVE",0,99 2510     Print "INPUT ANGLE,VELOCITY" 2512     Rcall "MOVE",0,98.8 2514     Rcall "rdraw",33,0 2520     Rcall "MOVE",90,99 2530     Print "INPUT ANGLE,VELOCITY" 2532     Rcall "move",90,98.8 2534     Rcall "rdraw",34,0 2540     Rcall "MOVE",50,90 2550     Print "CASUALTIES" 2560     Rcall "MOVE",48,87 2570     Print using "5D,5D":t1(1),t1(2) 2580     Rcall "MOVE",42,99 2590     Print "+ WIND IS TO THE RIGHT" 2600     Rcall "MOVE",42,96 2610     Print "- WIND IS TO THE LEFT" 2620     Return