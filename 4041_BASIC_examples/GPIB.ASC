100On srq then call s_rq!REM SET UP THE SQR HANDLER110Enab srq!REM ALLOW THE 4041 TO HANDLE SRQ'S120Sele"gpib:"!REM SELECT THE PROPER PORT130Set upca 1!REM UPERCASE AND LOWERCASE ARE IDENTICAL140Inte a_dd,h_owmuch150Inpu prom"HOW MANY DEVICES ":h_owmuch!REM HOW MANY YOU GOT160Dim d_ev(h_owmuch),cmd$ to 25,gozin$ to 256170For a_dd=1 to h_owmuch!REM LOOP TO CREATE LOGIC UNITS180Prin"ENTER DEVICE#";a_dd;" ADDRESS ";!REM GET AN ADDRESS190Inpu d_ev(a_dd)200Open#d_ev(a_dd):"GPIB(PRI="&str$(d_ev(a_dd))&"):"210!REM THE LINE ABOVE WILL OPEN APPROPRIATE DRIVERS FOR GPIB220Prin ask$("lu",d_ev(a_dd))230!REM THE LINE ABOVE PRINTS THE STATUS OF THE NEW LOGIC LU240Next a_dd250Start:inpu prom"COMMAND: ":cmd$!REM ENTER COMMAND STRING260If cmd$="END"then goto finish!REM GIVE A PROGRAM OUT270For gozout=1 to h_owmuch!REM SEND IT TO ALL LOGIC LU'S280Prin#d_ev(gozout):cmd$!REM SEND COMMAND OUT290Inpu#d_ev(gozout):gozin$!REM GET ANY RESPONSE300Prin gozin$!REM PRINT WHAT YOU GOT310Prin 320Next gozout330Goto start340Finish:end400Sub s_rq loca add,sta!REM THE HANDLER410Inte sta,add!DO GENERAL POLL TO FIND WHO SRQ'ED420Poll sta,add430Prin"DEVICE #";add;" HAS ISSUED SRQ"440Prin"THE STATUS MESSAGE IS ";sta450Resu!REM THE ONLY WAY TO EXIT A HANDLER460End!REM THE END OF SRQ HANDLER