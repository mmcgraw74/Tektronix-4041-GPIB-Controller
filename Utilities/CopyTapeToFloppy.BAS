100 Dim name$ to 12,prompt$ to 1,answer$ to 3,select$ to 1110 On error(842) then call err_hdlr ! error code for tape not in place120 On error(843) then call err_hdlr ! error code for tape is write protected130 On error(849) then call err_hdlr ! error code for tape timed out140 On error(851) then call err_hdlr ! error code for no room left on tape150 On error(853) then call err_hdlr ! error code for file doesn't exist on tape160 On error(1202 to 1203) then call err_hdlr ! error code for no space on disk170 On error(1205) then call err_hdlr ! error code for file doesn't exist on disk180 On error(1207) then call err_hdlr ! error code for no disk or unformatted disk190 On error(1213) then call err_hdlr ! error code for disk is write protected200 Print using "31x,30x,19a":"Copy  Program  Menu"210 Print using "30x,19('-'),/,l,25x,35a":"A : Copy from tape to floppy disk"220 Print using "25x,31a":"B : Copy from tape to hard disk"230 Print using "25x,33a":"C : Copy from floppy disk to tape"240 Print using "25x,38a":"D : Copy from floppy disk to hard disk"250 Print using "25x,3la":"E : Copy from hard disk to tape"260 Print using "25x,38a":"F : Copy from hard disk to floppy disk"270 Print using "25x,26a":"G : Exit copy program menu"280 Print using "l,30x,18a":"Enter selection : ";290 Input select$300 Select$=seg$(select$,1,1)310 If len(select$)=0 then goto 350 320 Rem convert lower case letters to upper case330 If asc(select$)>96 then select$=chr$(asc(select$)-32)340 If select$="A" and select$<="F" then goto 370345 GOTO 630350 Print using "30x,20a":"ERROR in selection"360 Goto 280370 Gosub asc(select$)-64 of 390,630,870,1120,1360,1610,1850380 Goto 200390 Rem setup for tape to floppy copy400 Print using "2/":410 Input prompt "Enter file name ( <RETURN> for directory ) : ":name$420 If len(name$)<>0 then goto 460430 Dir "tape:" to "comm:" ! produce a directory of tape on system console 440 Input prompt "Do you wish to continue with copy procedure : ":answer$ 450 If len(answer$)=0 or seg$(answer$,1,1)="n" then return else goto 410460 Rem setup copy command470 Open #50: "tape:"&name$&"(open=old)" ! open file to check file type 480 Rem File types 0 through 2 are considered ascii format and file types490 Rem 3 through 7 are item format500 If type(50)<3 then type$="asc" else type$="ite"510 Close (50)520 Rem format for copy command is 'copy <source> to <destination>' 530 Rem the stream spec 'disk(dev=O,uni=2)' specifies to access disk540 Rem controller card configured as device O and to address the floppy550 Rem disk drive.  The spec '(open=rep,clip=yes,form=' says to open the 560 Rem destination file to create a file if one does not exist or to 570 Rem replace the file if it already exists.  The 'clip=yes' says to allocate580 Rem just enough space to hold the file and the 'form=' tells the system590 Rem whether the file is to be saved n ASCII or ITEM format600 Copy "tape:"&name$ to "disk(dev=0,uni=2):"&name$&"(ope=rep,clip=yes,for="&type$&")"610 Print "Copy complete" 620 Return630 END